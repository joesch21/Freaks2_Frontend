/* ============== Core Layout ============== */
:root {
  --card-max: 720px;
  --pad: clamp(16px, 2.5vw, 28px);
  --radius: 20px;
  --glass-bg: rgba(10, 10, 20, 0.60);
  --glass-stroke: rgba(255, 255, 255, 0.12);
  --shadow: 0 10px 30px rgba(0,0,0,0.35);
}

html, body {
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  color: #f5f7ff; /* brighter default text */
}

/* Title: readable horror vibe (outline to pop on bright image) */
.condor-title {
  font-family: "Creepster", cursive;
  font-weight: 400;
  letter-spacing: .5px;
  text-shadow: 0 3px 16px rgba(0,0,0,.55), 0 1px 0 rgba(0,0,0,.9);
  -webkit-text-stroke: 1px rgba(0,0,0,.55); /* subtle edge for contrast */
  color: #fff;
}
.subtext {
  color: #e9ecff;
  text-shadow: 0 2px 8px rgba(0,0,0,.6);
}

/* Stronger legibility where text sits (top-left) */
.vignette {
  position: absolute; inset: 0;
  background:
    radial-gradient(1100px 650px at 24% 18%, rgba(0,0,0,.55) 0%, rgba(0,0,0,.25) 45%, transparent 70%),
    linear-gradient(180deg, rgba(0,0,0,.12) 0%, rgba(0,0,0,.78) 100%);
}

/* Buttons: brighter on dark */
button {
  color: #f7f9ff;
  border-color: rgba(255,255,255,.22);
  background: rgba(255,255,255,.10);
}
button:hover:not(:disabled), button:focus-visible:not(:disabled) {
  background: rgba(255,255,255,.18);
}

/* ===== Eye glint (reduced + calibratable) ===== */
.eye-layer {
  position: absolute; inset: 0; pointer-events: none; z-index: 1;

  /* Calibrate these 2 values to move the glint if your crop changes */
  --eye-base-x: 43%; /* ← move left/right */
  --eye-base-y: 24%; /* ← move up/down */

  /* live offsets from JS get added; leave these alone */
  --eye-left: var(--eye-base-x);
  --eye-top:  var(--eye-base-y);
}

/* Use the computed --eye-left / --eye-top from JS */
.eye-layer .glint,
.eye-layer .halo {
  position: absolute;
  left: var(--eye-left); top: var(--eye-top);
  transform: translate(-50%, -50%);
  border-radius: 50%;
  mix-blend-mode: screen;
  pointer-events: none;
}

/* Smaller, softer glint */
.eye-layer .glint {
  width: 22px; height: 22px;
  background: radial-gradient(circle at 42% 42%,
              rgba(255,255,255,.92) 0 4px,
              rgba(255,255,255,.24) 6px,
              rgba(255,210,60,.10) 10px,
              transparent 16px);
  filter: blur(.4px);
  opacity: .85;
}
.eye-layer .halo {
  width: 66px; height: 66px;
  background: radial-gradient(circle,
              rgba(255,170,0,.18) 0 14px,
              rgba(255,0,0,.08) 28px,
              transparent 50px);
  animation: eye-simmer 2.6s ease-in-out infinite alternate;
}

/* Optional: hide glint on small screens if it ever feels too bright */
@media (max-width: 480px) 
 {}
  .eye-layer { display:none; } 

.stage {
  position: relative;
  min-height: 100dvh;
  display: grid;
  grid-template-rows: 1fr auto;
  overflow: hidden;
}

/* Full-screen poster */
.poster { position: absolute; inset: 0; margin: 0; overflow: hidden; }
#freakyPoster {
  width: 100%; height: 100%; object-fit: cover; will-change: transform, filter;
  transform-origin: 50% 40%;                 /* anchor near the eyes */
  animation: condor-breathe 7s ease-in-out infinite;
  filter: url(#condorWiggle);
}
.vignette {
  position: absolute; inset: 0;
  background:
    radial-gradient(1200px 700px at 35% 30%, transparent 0%, rgba(0,0,0,.55) 70%),
    linear-gradient(180deg, rgba(0,0,0,.15) 0%, rgba(0,0,0,.75) 100%);
}

/* Film grain / flicker overlay */
.poster::after {
  content: "";
  position: absolute; inset: -10%;
  background:
    radial-gradient(transparent 60%, rgba(0,0,0,.25) 100%),
    repeating-linear-gradient(0deg, rgba(255,255,255,.02) 0 2px, rgba(0,0,0,.02) 2px 4px);
  mix-blend-mode: overlay;
  pointer-events: none;
  animation: film-flicker 3.5s steps(60) infinite;
  opacity: .9;
}

/* Floating title */
.heroTitle {
  position: relative; z-index: 1;
  padding: clamp(16px, 3vw, 28px);
  color: #f3f3f3;
  text-shadow: 0 2px 10px rgba(0,0,0,.7);
}
.condor-title { font-family: "Creepster", cursive; font-size: clamp(28px, 4vw, 44px); margin: 0 0 6px; }
.subtext { margin: 0; opacity: .95; }

/* Right dock */
.dock {
  position: fixed; right: 16px; top: 16px; bottom: 110px;
  width: min(360px, 92vw);
  z-index: 2;
  border-radius: 18px;
  background: rgba(10,10,20,.55);
  border: 1px solid rgba(255,255,255,.12);
  backdrop-filter: blur(12px) saturate(1.1);
  -webkit-backdrop-filter: blur(12px) saturate(1.1);
  box-shadow: 0 10px 30px rgba(0,0,0,.35);
  transition: transform .25s ease, background .25s ease;
  overflow: hidden;
}
@media (hover: hover) and (pointer: fine) {
  .dock:hover, .dock:focus-within { background: rgba(10,10,20,.68); }
}
.dock-inner { padding: 14px 16px; height: 100%; overflow: auto; }
.deeplink { color: #00ff88; font-weight: 700; }

/* Participants bottom rail */
.participants {
  position: fixed;
  left: 16px; right: 16px; bottom: 20px;
  z-index: 1;
  padding: 10px 12px;
  border-radius: 14px;
  background: rgba(0,0,0,.55);
  border: 1px solid rgba(255,255,255,.12);
  color: #e9e9e9;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}
.participants h4 { margin: 0 0 6px; }

/* Footer */
.footer { position: relative; z-index: 1; padding: 10px var(--pad) 20px; text-align: center; }

/* Buttons quick polish (optional) */
button {
  appearance: none; border: 1px solid rgba(255,255,255,.15);
  background: rgba(255,255,255,.06); color: #f3f3f3;
  border-radius: 10px; padding: 10px 12px; font-weight: 600;
  cursor: pointer; transition: transform .1s ease, background .2s ease, border-color .2s ease;
}
button:disabled { opacity: .55; cursor: not-allowed; }
button:hover:not(:disabled), button:focus-visible:not(:disabled) {
  background: rgba(255,255,255,.12); transform: translateY(-1px);
}

/* Spinner (basic) */
#loader { position: fixed; inset: 0; display: grid; place-items: center; background: rgba(0,0,0,.45); z-index: 9; }
#loader.hidden { display: none; }
.spinner { width: 44px; height: 44px; border-radius: 50%; border: 3px solid rgba(255,255,255,.25); border-top-color: #fff; animation: spin 1s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }

/* ============== Dynamic Poster FX ============== */
@keyframes condor-breathe {
  0%   { transform: scale(1.04) translateZ(0); }
  50%  { transform: scale(1.07) translateZ(0); }
  100% { transform: scale(1.04) translateZ(0); }
}
@keyframes film-flicker {
  0% { transform: translate3d(0,0,0); }
  100% { transform: translate3d(0,-2%,0); }
}

/* Eye glint */
.eye-layer {
  position: absolute; inset: 0; pointer-events: none; z-index: 1;
  --eye-left: 46%;
  --eye-top: 27%;
}
.eye-layer .glint,
.eye-layer .halo {
  position: absolute; left: var(--eye-left); top: var(--eye-top);
  transform: translate(-50%, -50%);
  border-radius: 50%;
  mix-blend-mode: screen;
  pointer-events: none;
}
.eye-layer .glint {
  width: 32px; height: 32px;
  background: radial-gradient(circle at 40% 40%, rgba(255,255,255,.95) 0 6px, rgba(255,255,255,.25) 9px, rgba(255,200,0,.12) 14px, transparent 22px);
  filter: blur(.6px);
}
.eye-layer .halo {
  width: 84px; height: 84px;
  background: radial-gradient(circle, rgba(255,170,0,.22) 0 18px, rgba(255,0,0,.10) 35px, transparent 60px);
  animation: eye-simmer 2.6s ease-in-out infinite alternate;
}
@keyframes eye-simmer {
  from { opacity: .75; transform: translate(-50%,-50%) scale(0.97); }
  to   { opacity: 1;    transform: translate(-50%,-50%) scale(1.03); }
}

/* Heartbeat state (added by JS when countdown <= 60s) */
.heartbeat #freakyPoster {
  animation: condor-breathe 7s ease-in-out infinite, heart-pulse 1.05s ease-in-out infinite;
  filter: url(#condorWiggle) brightness(1.03) contrast(1.03);
}
.heartbeat .vignette {
  background:
    radial-gradient(1200px 700px at 35% 30%, rgba(180,0,0,.18) 0%, rgba(0,0,0,.55) 70%),
    linear-gradient(180deg, rgba(60,0,0,.25) 0%, rgba(0,0,0,.8) 100%);
}
@keyframes heart-pulse {
  0%   { transform: scale(1.070); }
  20%  { transform: scale(1.090); }
  35%  { transform: scale(1.075); }
  60%  { transform: scale(1.095); }
  100% { transform: scale(1.070); }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  #freakyPoster, .poster::after { animation: none !important; }
  #freakyPoster { transform: none; filter: none; }
  .heartbeat .vignette { background: none; }
}

/* Mobile tweaks */
@media (max-width: 768px) {
  .dock {
    left: 16px; right: 16px; top: auto; bottom: 96px;
    width: auto; height: auto;
  }
}
/* ==== Dock “tab” control ==== */
.dock {
  /* existing styles… */
  transition: transform .25s ease, background .25s ease, top .25s ease, bottom .25s ease;
}

/* Handle strip at the top of the dock */
.dock-handle {
  display: grid; grid-template-columns: 24px 1fr 18px; align-items: center;
  width: 100%;
  margin: -2px 0 10px;
  padding: 8px 10px;
  border-radius: 12px;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.12);
  color: #f6f7ff; font-weight: 700; letter-spacing: .2px;
  cursor: pointer;
}
.dock-handle .grip { opacity: .7; }
.dock-handle .chev { opacity: .85; transition: transform .25s ease; }
.dock.collapsed .dock-handle .chev { transform: rotate(-180deg); }

/* Collapsed (tab-only) state */
.dock.collapsed {
  height: 56px; overflow: hidden;
}

/* Snap positions (desktop default: right side). Use one of these classes */
.dock.pos-top    { top: 16px;  bottom: auto; }
.dock.pos-bottom { top: auto;  bottom: 16px; }

/* Auto-hide on scroll (slides off-screen slightly) */
.dock.autohide.hide {
  transform: translateY(12px) translateX(0) translateZ(0);
  opacity: .96;
}

/* Mobile defaults: bottom & full width */
@media (max-width: 768px) {
  .dock { left: 16px; right: 16px; width: auto; }
  .dock.pos-top    { top: auto; bottom: 96px; }   /* keep it out of notch area */
  .dock.pos-bottom { bottom: 96px; top: auto; }
}

/* Optional: subtle grab cursor while dragging */
.dock.grabbing, .dock-handle:active { cursor: grabbing; }
